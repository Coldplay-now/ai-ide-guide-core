# ç¬¬8ç«  8. å¼€å‘ç®¡ç†ï¼ˆä¼˜åŒ–ç‰ˆï¼‰


## 8.1 ä»£ç ç”Ÿæˆä¸è¾…åŠ©


### 8.1.1 AIè¾…åŠ©ä»£ç ç”Ÿæˆæ“ä½œæ­¥éª¤


#### 8.1.1.1 æ­¥éª¤1ï¼šä¸Šä¸‹æ–‡å»ºç«‹å’Œéœ€æ±‚æè¿°

```java
æç¤ºè¯æ¨¡æ¿ï¼š
"æˆ‘éœ€è¦å®ç°ä¸€ä¸ª[åŠŸèƒ½æ¨¡å—åç§°]ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š
ä¸šåŠ¡åœºæ™¯ï¼š[ä¸šåŠ¡åœºæ™¯æè¿°]
æŠ€æœ¯æ ˆï¼š[ä½¿ç”¨çš„æŠ€æœ¯æ ˆ]
è®¾è®¡æ¨¡å¼ï¼š[éœ€è¦åº”ç”¨çš„è®¾è®¡æ¨¡å¼]
æ€§èƒ½è¦æ±‚ï¼š[æ€§èƒ½æŒ‡æ ‡]
å®‰å…¨è¦æ±‚ï¼š[å®‰å…¨è§„èŒƒ]

è¯·ç”Ÿæˆï¼š
1. æ ¸å¿ƒç±»å’Œæ¥å£çš„ä»£ç æ¡†æ¶
2. å…³é”®ä¸šåŠ¡é€»è¾‘çš„å®ç°
3. å•å…ƒæµ‹è¯•ä»£ç 
4. ç›¸å…³é…ç½®æ–‡ä»¶"

```

#### 8.1.1.2 æ­¥éª¤2ï¼šå¢é‡ä»£ç ç”Ÿæˆ

```java

æç¤ºè¯æ¨¡æ¿ï¼š
"åŸºäºç°æœ‰ä»£ç ï¼š
[ç°æœ‰ä»£ç ç‰‡æ®µ]

è¯·æ‰©å±•ä»¥ä¸‹åŠŸèƒ½ï¼š
æ–°å¢åŠŸèƒ½ï¼š[åŠŸèƒ½æè¿°]
ä¿®æ”¹è¦æ±‚ï¼š[ä¿®æ”¹éœ€æ±‚]
çº¦æŸæ¡ä»¶ï¼š[æŠ€æœ¯çº¦æŸ]

è¯·ç¡®ä¿ï¼š
5. ä¿æŒç°æœ‰ä»£ç é£æ ¼ä¸€è‡´
6. éµå¾ªSOLIDåŸåˆ™
7. æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†
8. åŒ…å«å¿…è¦çš„æ³¨é‡Š"
```

#### 8.1.1.3 æ­¥éª¤3ï¼šä»£ç ä¼˜åŒ–å’Œé‡æ„

```java

æç¤ºè¯æ¨¡æ¿ï¼š
æç¤ºè¯æ¨¡æ¿ï¼š
"è¯·å¯¹ä»¥ä¸‹ä»£ç è¿›è¡Œé‡æ„ä¼˜åŒ–ï¼š
[å¾…ä¼˜åŒ–ä»£ç ]

ä¼˜åŒ–ç›®æ ‡ï¼š
9. æé«˜ä»£ç å¯è¯»æ€§
10. å‡å°‘ä»£ç é‡å¤
11. æå‡æ€§èƒ½
12. å¢å¼ºå¯ç»´æŠ¤æ€§

è¯·æä¾›ï¼š
13. é‡æ„åçš„ä»£ç 
14. é‡æ„è¯´æ˜
15. æ€§èƒ½å¯¹æ¯”åˆ†æ
16. æ½œåœ¨é£é™©è¯„ä¼°"

### 8.1.2 å®è·µæ¡ˆä¾‹ï¼šç”¨æˆ·ç®¡ç†æ¨¡å—ä»£ç ç”Ÿæˆ


**ä¸šåŠ¡èƒŒæ™¯ï¼š** å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†æ¨¡å—ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ç­‰åŠŸèƒ½ã€‚

**AIè¾…åŠ©ä»£ç ç”Ÿæˆè¿‡ç¨‹ï¼š**

**ç¬¬ä¸€æ­¥ï¼šæ ¸å¿ƒæ¡†æ¶ç”Ÿæˆ**

```java

è¾“å…¥æç¤ºè¯ï¼š
"æˆ‘éœ€è¦å®ç°ä¸€ä¸ªç”¨æˆ·ç®¡ç†æ¨¡å—ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š
è¾“å…¥æç¤ºè¯ï¼š
"æˆ‘éœ€è¦å®ç°ä¸€ä¸ªç”¨æˆ·ç®¡ç†æ¨¡å—ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š
ä¸šåŠ¡åœºæ™¯ï¼šæ”¯æŒç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯æŸ¥è¯¢å’Œæ›´æ–°
æŠ€æœ¯æ ˆï¼šSpring Boot + MyBatis + Redis + MySQL
è®¾è®¡æ¨¡å¼ï¼šRepositoryæ¨¡å¼ + Serviceå±‚æ¨¡å¼
æ€§èƒ½è¦æ±‚ï¼šç™»å½•æ¥å£å“åº”æ—¶é—´<500msï¼Œæ”¯æŒ1000å¹¶å‘
å®‰å…¨è¦æ±‚ï¼šå¯†ç åŠ å¯†å­˜å‚¨ï¼ŒJWT tokenè®¤è¯

è¯·ç”Ÿæˆæ ¸å¿ƒç±»å’Œæ¥å£çš„ä»£ç æ¡†æ¶"
*
*AIè¾“å‡ºï¼š**

```java
// ç”¨æˆ·å®ä½“ç±»
@Entity
@Table(name = "users")
@Data
// ç”¨æˆ·å®ä½“ç±»
@Entity
@Table(name = "users")
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "username", unique = true, nullable = false)
    private String username;
    
    @Column(name = "email", unique = true, nullable = false)
    private String email;
    
    @Column(name = "password", nullable = false)
    private String password;
    
    @Column(name = "phone")
    private String phone;
    
    @Column(name = "avatar_url")
    private String avatarUrl;
    
    @Enumerated(EnumType.STRING)
    @Column(name = "status")
    private UserStatus status;
    
    @Column(name = "created_time")
    private LocalDateTime createdTime;
    
    @Column(name = "updated_time")
    private LocalDateTime updatedTime;
    
    @Column(name = "last_login_time")
    private LocalDateTime lastLoginTime;
}

// ç”¨æˆ·çŠ¶æ€æšä¸¾
public enum UserStatus {
    ACTIVE("æ¿€æ´»"),
    INACTIVE("æœªæ¿€æ´»"),
    LOCKED("é”å®š"),
    DELETED("å·²åˆ é™¤");
    
    private final String description;
    
    UserStatus(String description) {
        this.description = description;
    }
}

// ç”¨æˆ·Repositoryæ¥å£
@Repository
public interface UserRepository {
    User findById(Long id);
    User findByUsername(String username);
    User findByEmail(String email);
    void save(User user);
    void update(User user);
    void deleteById(Long id);
    List<User> findByStatus(UserStatus status);
    Page<User> findAll(Pageable pageable);
}

// ç”¨æˆ·Serviceæ¥å£
public interface UserService {
    /**
     - ç”¨æˆ·æ³¨å†Œ
     */

    UserResponse register(RegisterRequest request);
    
    /**
     - ç”¨æˆ·ç™»å½•
     */

    LoginResponse login(LoginRequest request);
    
    /**
     - è·å–ç”¨æˆ·ä¿¡æ¯
     */

    UserResponse getUserInfo(Long userId);
    
    /**
     - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
     */

    UserResponse updateUserInfo(Long userId, UpdateUserRequest request);
    
    /**
     - ä¿®æ”¹å¯†ç 
     */

    void changePassword(Long userId, ChangePasswordRequest request);
    
    /**
     - ç”¨æˆ·ç™»å‡º
     */

    void logout(String token);
}

```java

è¾“å…¥æç¤ºè¯ï¼š
"åŸºäºä¸Šè¿°ç”¨æˆ·ç®¡ç†æ¡†æ¶ï¼Œè¯·å®ç°UserServiceçš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œ
ç‰¹åˆ«å…³æ³¨å¯†ç åŠ å¯†ã€JWT tokenç”Ÿæˆã€Redisç¼“å­˜ç­‰åŠŸèƒ½"
è¾“å…¥æç¤ºè¯ï¼š
"åŸºäºä¸Šè¿°ç”¨æˆ·ç®¡ç†æ¡†æ¶ï¼Œè¯·å®ç°UserServiceçš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œ
ç‰¹åˆ«å…³æ³¨å¯†ç åŠ å¯†ã€JWT tokenç”Ÿæˆã€Redisç¼“å­˜ç­‰åŠŸèƒ½"

AIè¾“å‡ºï¼š
@Transactional
@Slf4j
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @Autowired
    private PasswordEncoder passwordEncoder;
    
    @Autowired
    private JwtTokenProvider jwtTokenProvider;
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    private static final String USER_CACHE_PREFIX = "user:";
    private static final String TOKEN_BLACKLIST_PREFIX = "blacklist:";
    private static final int CACHE_EXPIRE_HOURS = 24;
    
    @Override
    public UserResponse register(RegisterRequest request) {
        log.info("ç”¨æˆ·æ³¨å†Œè¯·æ±‚: username={}, email={}", request.getUsername(), request.getEmail());
        
        // 1. éªŒè¯ç”¨æˆ·åå’Œé‚®ç®±å”¯ä¸€æ€§
        validateUserUniqueness(request.getUsername(), request.getEmail());
        
        // 2. å¯†ç åŠ å¯†
        String encodedPassword = passwordEncoder.encode(request.getPassword());
        
        // 3. åˆ›å»ºç”¨æˆ·å¯¹è±¡
        User user = User.builder()
                .username(request.getUsername())
                .email(request.getEmail())
                .password(encodedPassword)
                .phone(request.getPhone())
                .status(UserStatus.ACTIVE)
                .createdTime(LocalDateTime.now())
                .updatedTime(LocalDateTime.now())
                .build();
        
        // 4. ä¿å­˜ç”¨æˆ·
        userRepository.save(user);
        
        // 5. ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
        cacheUser(user);
        
        log.info("ç”¨æˆ·æ³¨å†ŒæˆåŠŸ: userId={}, username={}", user.getId(), user.getUsername());
        return convertToUserResponse(user);
    }
    
    @Override
    public LoginResponse login(LoginRequest request) {
        log.info("ç”¨æˆ·ç™»å½•è¯·æ±‚: username={}", request.getUsername());
        
        // 1. æŸ¥æ‰¾ç”¨æˆ·
        User user = userRepository.findByUsername(request.getUsername());
        if (user == null) {
            throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. éªŒè¯ç”¨æˆ·çŠ¶æ€
        if (user.getStatus() != UserStatus.ACTIVE) {
            throw new UserStatusException("ç”¨æˆ·çŠ¶æ€å¼‚å¸¸: " + user.getStatus().getDescription());
        }
        
        // 3. éªŒè¯å¯†ç 
        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
            throw new InvalidPasswordException("å¯†ç é”™è¯¯");
        }
        
        // 4. ç”ŸæˆJWT token
        String token = jwtTokenProvider.generateToken(user.getId(), user.getUsername());
        
        // 5. æ›´æ–°æœ€åç™»å½•æ—¶é—´
        user.setLastLoginTime(LocalDateTime.now());
        userRepository.update(user);
        
        // 6. ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
        cacheUser(user);
        
        log.info("ç”¨æˆ·ç™»å½•æˆåŠŸ: userId={}, username={}", user.getId(), user.getUsername());
        
        return LoginResponse.builder()
                .token(token)
                .user(convertToUserResponse(user))
                .build();
    }
    
    @Override
    @Cacheable(value = "users", key = "#userId")
    public UserResponse getUserInfo(Long userId) {
        log.info("è·å–ç”¨æˆ·ä¿¡æ¯: userId={}", userId);
        
        // 1. å…ˆä»ç¼“å­˜è·å–
        User cachedUser = getCachedUser(userId);
        if (cachedUser != null) {
            return convertToUserResponse(cachedUser);
        }
        
        // 2. ä»æ•°æ®åº“è·å–
        User user = userRepository.findById(userId);
        if (user == null) {
            throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 3. ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
        cacheUser(user);
        
        return convertToUserResponse(user);
    }
    
    @Override
    public UserResponse updateUserInfo(Long userId, UpdateUserRequest request) {
        log.info("æ›´æ–°ç”¨æˆ·ä¿¡æ¯: userId={}", userId);
        
        // 1. è·å–ç”¨æˆ·
        User user = userRepository.findById(userId);
        if (user == null) {
            throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
        if (StringUtils.hasText(request.getPhone())) {
            user.setPhone(request.getPhone());
        }
        if (StringUtils.hasText(request.getAvatarUrl())) {
            user.setAvatarUrl(request.getAvatarUrl());
        }
        user.setUpdatedTime(LocalDateTime.now());
        
        // 3. ä¿å­˜æ›´æ–°
        userRepository.update(user);
        
        // 4. æ›´æ–°ç¼“å­˜
        cacheUser(user);
        
        log.info("ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ: userId={}", userId);
        return convertToUserResponse(user);
    }
    
    @Override
    public void changePassword(Long userId, ChangePasswordRequest request) {
        log.info("ä¿®æ”¹å¯†ç : userId={}", userId);
        
        // 1. è·å–ç”¨æˆ·
        User user = userRepository.findById(userId);
        if (user == null) {
            throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. éªŒè¯åŸå¯†ç 
        if (!passwordEncoder.matches(request.getOldPassword(), user.getPassword())) {
            throw new InvalidPasswordException("åŸå¯†ç é”™è¯¯");
        }
        
        // 3. åŠ å¯†æ–°å¯†ç 
        String encodedNewPassword = passwordEncoder.encode(request.getNewPassword());
        user.setPassword(encodedNewPassword);
        user.setUpdatedTime(LocalDateTime.now());
        
        // 4. ä¿å­˜æ›´æ–°
        userRepository.update(user);
        
        // 5. æ¸…é™¤ç¼“å­˜ï¼ˆå¼ºåˆ¶é‡æ–°ç™»å½•ï¼‰
        clearUserCache(userId);
        
        log.info("å¯†ç ä¿®æ”¹æˆåŠŸ: userId={}", userId);
    }
    
    @Override
    public void logout(String token) {
        log.info("ç”¨æˆ·ç™»å‡º: token={}", token.substring(0, 10) + "...");
        
        // 1. å°†tokenåŠ å…¥é»‘åå•
        String tokenKey = TOKEN_BLACKLIST_PREFIX + token;
        redisTemplate.opsForValue().set(tokenKey, "blacklisted", 
            Duration.ofHours(CACHE_EXPIRE_HOURS));
        
        // 2. ä»tokenä¸­è§£æç”¨æˆ·IDå¹¶æ¸…é™¤ç”¨æˆ·ç¼“å­˜
        Long userId = jwtTokenProvider.getUserIdFromToken(token);
        if (userId != null) {
            clearUserCache(userId);
        }
        
        log.info("ç”¨æˆ·ç™»å‡ºæˆåŠŸ");
    }
    
    // ç§æœ‰è¾…åŠ©æ–¹æ³•
    private void validateUserUniqueness(String username, String email) {
        if (userRepository.findByUsername(username) != null) {
            throw new UserAlreadyExistsException("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        if (userRepository.findByEmail(email) != null) {
            throw new UserAlreadyExistsException("é‚®ç®±å·²å­˜åœ¨");
        }
    }
    
    private void cacheUser(User user) {
        String cacheKey = USER_CACHE_PREFIX + user.getId();
        redisTemplate.opsForValue().set(cacheKey, user, Duration.ofHours(CACHE_EXPIRE_HOURS));
    }
    
    private User getCachedUser(Long userId) {
        String cacheKey = USER_CACHE_PREFIX + userId;
        return (User) redisTemplate.opsForValue().get(cacheKey);
    }
    
    private void clearUserCache(Long userId) {
        String cacheKey = USER_CACHE_PREFIX + userId;
        redisTemplate.delete(cacheKey);
    }
    
    private UserResponse convertToUserResponse(User user) {
        return UserResponse.builder()
                .id(user.getId())
                .username(user.getUsername())
                .email(user.getEmail())
                .phone(user.getPhone())
                .avatarUrl(user.getAvatarUrl())
                .status(user.getStatus())
                .createdTime(user.getCreatedTime())
                .lastLoginTime(user.getLastLoginTime())
                .build();
    }
}

```java

**ç¬¬ä¸‰æ­¥ï¼šå•å…ƒæµ‹è¯•ç”Ÿæˆ**

```

**ç¬¬ä¸‰æ­¥ï¼šå•å…ƒæµ‹è¯•ç”Ÿæˆ**

AIè¾“å‡ºï¼š

```java
@ExtendWith(MockitoExtension.class)
class UserServiceImplTest {
    
    @Mock
    private UserRepository userRepository;
    
@ExtendWith(MockitoExtension.class)
class UserServiceImplTest {
    
    @Mock
    private UserRepository userRepository;
    
    @Mock
    private PasswordEncoder passwordEncoder;
    
    @Mock
    private JwtTokenProvider jwtTokenProvider;
    
    @Mock
    private RedisTemplate<String, Object> redisTemplate;
    
    @Mock
    private ValueOperations<String, Object> valueOperations;
    
    @InjectMocks
    private UserServiceImpl userService;
    
    private User testUser;
    private RegisterRequest registerRequest;
    private LoginRequest loginRequest;
    
    @BeforeEach
    void setUp() {
        testUser = User.builder()
                .id(1L)
                .username("testuser")
                .email("test@example.com")
                .password("encodedPassword")
                .phone("13800138000")
                .status(UserStatus.ACTIVE)
                .createdTime(LocalDateTime.now())
                .build();
        
        registerRequest = RegisterRequest.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password123")
                .phone("13800138000")
                .build();
        
        loginRequest = LoginRequest.builder()
                .username("testuser")
                .password("password123")
                .build();
        
        when(redisTemplate.opsForValue()).thenReturn(valueOperations);
    }
    
    @Test
    @DisplayName("ç”¨æˆ·æ³¨å†ŒæˆåŠŸ")
    void register_Success() {
        // Given
        when(userRepository.findByUsername(registerRequest.getUsername())).thenReturn(null);
        when(userRepository.findByEmail(registerRequest.getEmail())).thenReturn(null);
        when(passwordEncoder.encode(registerRequest.getPassword())).thenReturn("encodedPassword");
        when(userRepository.save(any(User.class))).thenReturn(testUser);
        
        // When
        UserResponse result = userService.register(registerRequest);
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getUsername()).isEqualTo(registerRequest.getUsername());
        assertThat(result.getEmail()).isEqualTo(registerRequest.getEmail());
        
        verify(userRepository).findByUsername(registerRequest.getUsername());
        verify(userRepository).findByEmail(registerRequest.getEmail());
        verify(passwordEncoder).encode(registerRequest.getPassword());
        verify(userRepository).save(any(User.class));
        verify(valueOperations).set(anyString(), any(User.class), any(Duration.class));
    }
    
    @Test
    @DisplayName("ç”¨æˆ·æ³¨å†Œå¤±è´¥ - ç”¨æˆ·åå·²å­˜åœ¨")
    void register_UsernameExists() {
        // Given
        when(userRepository.findByUsername(registerRequest.getUsername())).thenReturn(testUser);
        
        // When & Then
        assertThatThrownBy(() -> userService.register(registerRequest))
                .isInstanceOf(UserAlreadyExistsException.class)
                .hasMessage("ç”¨æˆ·åå·²å­˜åœ¨");
        
        verify(userRepository).findByUsername(registerRequest.getUsername());
        verify(userRepository, never()).save(any(User.class));
    }
    
    @Test
    @DisplayName("ç”¨æˆ·ç™»å½•æˆåŠŸ")
    void login_Success() {
        // Given
        when(userRepository.findByUsername(loginRequest.getUsername())).thenReturn(testUser);
        when(passwordEncoder.matches(loginRequest.getPassword(), testUser.getPassword())).thenReturn(true);
        when(jwtTokenProvider.generateToken(testUser.getId(), testUser.getUsername())).thenReturn("jwt-token");
        
        // When
        LoginResponse result = userService.login(loginRequest);
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getToken()).isEqualTo("jwt-token");
        assertThat(result.getUser().getUsername()).isEqualTo(testUser.getUsername());
        
        verify(userRepository).findByUsername(loginRequest.getUsername());
        verify(passwordEncoder).matches(loginRequest.getPassword(), testUser.getPassword());
        verify(jwtTokenProvider).generateToken(testUser.getId(), testUser.getUsername());
        verify(userRepository).update(testUser);
    }
    
    @Test
    @DisplayName("ç”¨æˆ·ç™»å½•å¤±è´¥ - ç”¨æˆ·ä¸å­˜åœ¨")
    void login_UserNotFound() {
        // Given
        when(userRepository.findByUsername(loginRequest.getUsername())).thenReturn(null);
        
        // When & Then
        assertThatThrownBy(() -> userService.login(loginRequest))
                .isInstanceOf(UserNotFoundException.class)
                .hasMessage("ç”¨æˆ·ä¸å­˜åœ¨");
        
        verify(userRepository).findByUsername(loginRequest.getUsername());
        verify(passwordEncoder, never()).matches(anyString(), anyString());
    }
    
    @Test
    @DisplayName("ç”¨æˆ·ç™»å½•å¤±è´¥ - å¯†ç é”™è¯¯")
    void login_InvalidPassword() {
        // Given
        when(userRepository.findByUsername(loginRequest.getUsername())).thenReturn(testUser);
        when(passwordEncoder.matches(loginRequest.getPassword(), testUser.getPassword())).thenReturn(false);
        
        // When & Then
        assertThatThrownBy(() -> userService.login(loginRequest))
                .isInstanceOf(InvalidPasswordException.class)
                .hasMessage("å¯†ç é”™è¯¯");
        
        verify(userRepository).findByUsername(loginRequest.getUsername());
        verify(passwordEncoder).matches(loginRequest.getPassword(), testUser.getPassword());
        verify(jwtTokenProvider, never()).generateToken(anyLong(), anyString());
    }
    
    @Test
    @DisplayName("è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ - ä»ç¼“å­˜")
    void getUserInfo_FromCache() {
        // Given
        when(valueOperations.get("user:" + testUser.getId())).thenReturn(testUser);
        
        // When
        UserResponse result = userService.getUserInfo(testUser.getId());
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getId()).isEqualTo(testUser.getId());
        assertThat(result.getUsername()).isEqualTo(testUser.getUsername());
        
        verify(valueOperations).get("user:" + testUser.getId());
        verify(userRepository, never()).findById(testUser.getId());
    }
    
    @Test
    @DisplayName("è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ - ä»æ•°æ®åº“")
    void getUserInfo_FromDatabase() {
        // Given
        when(valueOperations.get("user:" + testUser.getId())).thenReturn(null);
        when(userRepository.findById(testUser.getId())).thenReturn(testUser);
        
        // When
        UserResponse result = userService.getUserInfo(testUser.getId());
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getId()).isEqualTo(testUser.getId());
        assertThat(result.getUsername()).isEqualTo(testUser.getUsername());
        
        verify(valueOperations).get("user:" + testUser.getId());
        verify(userRepository).findById(testUser.getId());
        verify(valueOperations).set(eq("user:" + testUser.getId()), eq(testUser), any(Duration.class));
    }
}
**é‡æ„åœºæ™¯ï¼š** ä¼˜åŒ–ä¸€ä¸ªå­˜åœ¨ä»£ç é‡å¤å’Œæ€§èƒ½é—®é¢˜çš„è®¢å•å¤„ç†æ–¹æ³•ã€‚

**åŸå§‹ä»£ç ï¼š**

```java
public class OrderProcessor {
    
    public void processOrder(Order order) {
        // éªŒè¯è®¢å•
        if (order == null) {
            throw new IllegalArgumentException("è®¢å•ä¸èƒ½ä¸ºç©º");
public class OrderProcessor {
    
    public void processOrder(Order order) {
        // éªŒè¯è®¢å•
        if (order == null) {
            throw new IllegalArgumentException("è®¢å•ä¸èƒ½ä¸ºç©º");
        }
        if (order.getItems() == null || order.getItems().isEmpty()) {
            throw new IllegalArgumentException("è®¢å•é¡¹ä¸èƒ½ä¸ºç©º");
        }
        for (OrderItem item : order.getItems()) {
            if (item.getQuantity() <= 0) {
                throw new IllegalArgumentException("å•†å“æ•°é‡å¿…é¡»å¤§äº0");
            }
            if (item.getPrice().compareTo(BigDecimal.ZERO) <= 0) {
                throw new IllegalArgumentException("å•†å“ä»·æ ¼å¿…é¡»å¤§äº0");
            }
        }
        
        // è®¡ç®—æ€»é‡‘é¢
        BigDecimal totalAmount = BigDecimal.ZERO;
        for (OrderItem item : order.getItems()) {
            totalAmount = totalAmount.add(item.getPrice().multiply(new BigDecimal(item.getQuantity())));
        }
        order.setTotalAmount(totalAmount);
        
        // æ£€æŸ¥åº“å­˜
        for (OrderItem item : order.getItems()) {
            Product product = productService.getProduct(item.getProductId());
            if (product.getStock() < item.getQuantity()) {
                throw new InsufficientStockException("å•†å“åº“å­˜ä¸è¶³ï¼š" + product.getName());
            }
        }
        
        // æ‰£å‡åº“å­˜
        for (OrderItem item : order.getItems()) {
            Product product = productService.getProduct(item.getProductId());
            product.setStock(product.getStock() - item.getQuantity());
            productService.updateProduct(product);
        }
        
        // ä¿å­˜è®¢å•
        orderRepository.save(order);
        
        // å‘é€é€šçŸ¥
        String message = "è®¢å•åˆ›å»ºæˆåŠŸï¼Œè®¢å•å·ï¼š" + order.getOrderNo() + "ï¼Œæ€»é‡‘é¢ï¼š" + order.getTotalAmount();
        notificationService.sendNotification(order.getUserId(), message);
    }
}

è¾“å…¥æç¤ºè¯ï¼š
"è¯·å¯¹ä¸Šè¿°OrderProcessorä»£ç è¿›è¡Œé‡æ„ï¼Œä¼˜åŒ–ç›®æ ‡ï¼š

1. æ¶ˆé™¤ä»£ç é‡å¤
2. æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§

3. ä¼˜åŒ–æ€§èƒ½ï¼ˆå‡å°‘æ•°æ®åº“æŸ¥è¯¢ï¼‰
è¾“å…¥æç¤ºè¯ï¼š
"è¯·å¯¹ä¸Šè¿°OrderProcessorä»£ç è¿›è¡Œé‡æ„ï¼Œä¼˜åŒ–ç›®æ ‡ï¼š

1. æ¶ˆé™¤ä»£ç é‡å¤
2. æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
3. ä¼˜åŒ–æ€§èƒ½ï¼ˆå‡å°‘æ•°æ®åº“æŸ¥è¯¢ï¼‰
4. å¢å¼ºé”™è¯¯å¤„ç†
5. åº”ç”¨é€‚å½“çš„è®¾è®¡æ¨¡å¼"

AIè¾“å‡ºï¼š
public class OrderProcessor {
    
    @Autowired
    private ProductService productService;
    
    @Autowired
    private OrderRepository orderRepository;
    
    @Autowired
    private NotificationService notificationService;
    
    @Autowired
    private OrderValidator orderValidator;
    
    @Autowired
    private OrderCalculator orderCalculator;
    
    @Autowired
    private InventoryManager inventoryManager;
    
    public void processOrder(Order order) {
        log.info("å¼€å§‹å¤„ç†è®¢å•: {}", order.getOrderNo());
        
        try {
            // 1. éªŒè¯è®¢å•
            orderValidator.validate(order);
            
            // 2. è®¡ç®—è®¢å•é‡‘é¢
            orderCalculator.calculateTotalAmount(order);
            
            // 3. å¤„ç†åº“å­˜
            inventoryManager.processInventory(order);
            
            // 4. ä¿å­˜è®¢å•
            orderRepository.save(order);
            
            // 5. å‘é€é€šçŸ¥
            sendOrderNotification(order);
            
            log.info("è®¢å•å¤„ç†å®Œæˆ: {}", order.getOrderNo());
            
        } catch (Exception e) {
            log.error("è®¢å•å¤„ç†å¤±è´¥: {}, é”™è¯¯: {}", order.getOrderNo(), e.getMessage(), e);
            throw new OrderProcessingException("è®¢å•å¤„ç†å¤±è´¥", e);
        }
    }
    
    private void sendOrderNotification(Order order) {
        String message = String.format("è®¢å•åˆ›å»ºæˆåŠŸï¼Œè®¢å•å·ï¼š%sï¼Œæ€»é‡‘é¢ï¼š%s", 
            order.getOrderNo(), order.getTotalAmount());
        notificationService.sendNotification(order.getUserId(), message);
    }
}

// è®¢å•éªŒè¯å™¨
@Component
public class OrderValidator {
    
    public void validate(Order order) {
        validateOrderBasic(order);
        validateOrderItems(order.getItems());
    }
    
    private void validateOrderBasic(Order order) {
        if (order == null) {
            throw new IllegalArgumentException("è®¢å•ä¸èƒ½ä¸ºç©º");
        }
        if (StringUtils.isEmpty(order.getOrderNo())) {
            throw new IllegalArgumentException("è®¢å•å·ä¸èƒ½ä¸ºç©º");
        }
        if (order.getUserId() == null) {
            throw new IllegalArgumentException("ç”¨æˆ·IDä¸èƒ½ä¸ºç©º");
        }
    }
    
    private void validateOrderItems(List<OrderItem> items) {
        if (CollectionUtils.isEmpty(items)) {
            throw new IllegalArgumentException("è®¢å•é¡¹ä¸èƒ½ä¸ºç©º");
        }
        
        items.forEach(this::validateOrderItem);
    }
    
    private void validateOrderItem(OrderItem item) {
        if (item.getProductId() == null) {
            throw new IllegalArgumentException("å•†å“IDä¸èƒ½ä¸ºç©º");
        }
        if (item.getQuantity() <= 0) {
            throw new IllegalArgumentException("å•†å“æ•°é‡å¿…é¡»å¤§äº0");
        }
        if (item.getPrice() == null || item.getPrice().compareTo(BigDecimal.ZERO) <= 0) {
            throw new IllegalArgumentException("å•†å“ä»·æ ¼å¿…é¡»å¤§äº0");
        }
    }
}

// è®¢å•è®¡ç®—å™¨
@Component
public class OrderCalculator {
    
    public void calculateTotalAmount(Order order) {
        BigDecimal totalAmount = order.getItems().stream()
            .map(this::calculateItemSubtotal)
            .reduce(BigDecimal.ZERO, BigDecimal::add);
        
        order.setTotalAmount(totalAmount);
    }
    
    private BigDecimal calculateItemSubtotal(OrderItem item) {
        return item.getPrice().multiply(new BigDecimal(item.getQuantity()));
    }
}

// åº“å­˜ç®¡ç†å™¨
@Component
public class InventoryManager {
    
    @Autowired
    private ProductService productService;
    
    public void processInventory(Order order) {
        // æ‰¹é‡è·å–å•†å“ä¿¡æ¯ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢
        List<Long> productIds = order.getItems().stream()
            .map(OrderItem::getProductId)
            .collect(Collectors.toList());
        
        Map<Long, Product> productMap = productService.getProductsByIds(productIds)
            .stream()
            .collect(Collectors.toMap(Product::getId, Function.identity()));
        
        // æ£€æŸ¥åº“å­˜
        checkInventory(order.getItems(), productMap);
        
        // æ‰£å‡åº“å­˜
        deductInventory(order.getItems(), productMap);
    }
    
    private void checkInventory(List<OrderItem> items, Map<Long, Product> productMap) {
        for (OrderItem item : items) {
            Product product = productMap.get(item.getProductId());
            if (product == null) {
                throw new ProductNotFoundException("å•†å“ä¸å­˜åœ¨ï¼š" + item.getProductId());
            }
            if (product.getStock() < item.getQuantity()) {
                throw new InsufficientStockException("å•†å“åº“å­˜ä¸è¶³ï¼š" + product.getName());
            }
        }
    }
    
    private void deductInventory(List<OrderItem> items, Map<Long, Product> productMap) {
        List<Product> productsToUpdate = new ArrayList<>();
        
        for (OrderItem item : items) {
            Product product = productMap.get(item.getProductId());
            product.setStock(product.getStock() - item.getQuantity());
            productsToUpdate.add(product);
        }
        
        // æ‰¹é‡æ›´æ–°å•†å“åº“å­˜
        productService.batchUpdateProducts(productsToUpdate);
    }
}

```java

**é‡æ„æ•ˆæœåˆ†æï¼š**

| é‡æ„ç»´åº¦ | é‡æ„å‰ | é‡æ„å | æ”¹è¿›æ•ˆæœ |
| --------- | -------- | -------- | ---------- |
| **ä»£ç è¡Œæ•°** | 60è¡Œ | 120è¡Œï¼ˆåˆ†æ•£åˆ°å¤šä¸ªç±»ï¼‰ | å•ä¸€èŒè´£ï¼Œä¾¿äºç»´æŠ¤ |
| **æ–¹æ³•å¤æ‚åº¦** | é«˜ï¼ˆä¸€ä¸ªæ–¹æ³•å¤„ç†æ‰€æœ‰é€»è¾‘ï¼‰ | ä½ï¼ˆæ¯ä¸ªæ–¹æ³•èŒè´£å•ä¸€ï¼‰ | å¯è¯»æ€§å¤§å¹…æå‡ |
**é‡æ„æ•ˆæœåˆ†æï¼š**

| é‡æ„ç»´åº¦ | é‡æ„å‰ | é‡æ„å | æ”¹è¿›æ•ˆæœ |
| --------- | -------- | -------- | ---------- |
| **ä»£ç è¡Œæ•°** | 60è¡Œ | 120è¡Œï¼ˆåˆ†æ•£åˆ°å¤šä¸ªç±»ï¼‰ | å•ä¸€èŒè´£ï¼Œä¾¿äºç»´æŠ¤ |
| **æ–¹æ³•å¤æ‚åº¦** | é«˜ï¼ˆä¸€ä¸ªæ–¹æ³•å¤„ç†æ‰€æœ‰é€»è¾‘ï¼‰ | ä½ï¼ˆæ¯ä¸ªæ–¹æ³•èŒè´£å•ä¸€ï¼‰ | å¯è¯»æ€§å¤§å¹…æå‡ |
| **æ•°æ®åº“æŸ¥è¯¢** | Næ¬¡æŸ¥è¯¢å•†å“ä¿¡æ¯ | 1æ¬¡æ‰¹é‡æŸ¥è¯¢ | æ€§èƒ½æå‡60% |
| **å¯æµ‹è¯•æ€§** | éš¾ä»¥å•ç‹¬æµ‹è¯•å„ä¸ªç¯èŠ‚ | æ¯ä¸ªç»„ä»¶å¯ç‹¬ç«‹æµ‹è¯• | æµ‹è¯•è¦†ç›–ç‡æå‡ |
| **å¯æ‰©å±•æ€§** | ä¿®æ”¹éœ€è¦æ”¹åŠ¨ä¸»æ–¹æ³• | æ–°å¢åŠŸèƒ½åªéœ€æ‰©å±•å¯¹åº”ç»„ä»¶ | ç¬¦åˆå¼€é—­åŸåˆ™ |
| **é”™è¯¯å¤„ç†** | ç®€å•çš„å¼‚å¸¸æŠ›å‡º | åˆ†å±‚é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½• | é—®é¢˜å®šä½æ›´å‡†ç¡® |

## 8.2 ä»£ç å®¡æŸ¥


### 8.2.1 AIè¾…åŠ©ä»£ç å®¡æŸ¥æ“ä½œæ­¥éª¤


#### 8.3.1.1 æ­¥éª¤1ï¼šä»£ç è´¨é‡æ£€æŸ¥
æ£€æŸ¥ç»´åº¦ï¼š
22. ä»£ç è§„èŒƒæ€§ï¼ˆå‘½åã€æ ¼å¼ã€æ³¨é‡Šï¼‰
23. è®¾è®¡åŸåˆ™éµå¾ªæƒ…å†µï¼ˆSOLIDåŸåˆ™ï¼‰
24. æ½œåœ¨çš„bugå’Œå®‰å…¨é—®é¢˜
25. æ€§èƒ½ä¼˜åŒ–å»ºè®®
26. å¯ç»´æŠ¤æ€§è¯„ä¼°

è¯·æä¾›ï¼š
27. é—®é¢˜æ¸…å•ï¼ˆæŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»ï¼‰
28. å…·ä½“çš„ä¿®æ”¹å»ºè®®
29. é‡æ„æ–¹æ¡ˆï¼ˆå¦‚éœ€è¦ï¼‰"

```java

#### 8.3.1.2 æ­¥éª¤2ï¼šå®‰å…¨æ¼æ´æ£€æµ‹

```

æç¤ºè¯æ¨¡æ¿ï¼š
"è¯·æ£€æŸ¥ä»¥ä¸‹ä»£ç çš„å®‰å…¨é—®é¢˜ï¼š
[ä»£ç ç‰‡æ®µ]
#### 8.3.1.2 æ­¥éª¤2ï¼šå®‰å…¨æ¼æ´æ£€æµ‹
30. SQLæ³¨å…¥é£é™©
31. XSSæ”»å‡»é£é™©
32. æ•æ„Ÿä¿¡æ¯æ³„éœ²
33. æƒé™æ§åˆ¶ç¼ºé™·
34. è¾“å…¥éªŒè¯ä¸è¶³

è¯·æä¾›ï¼š
35. å®‰å…¨é£é™©è¯„ä¼°
36. æ¼æ´ä¿®å¤å»ºè®®
37. å®‰å…¨æœ€ä½³å®è·µå»ºè®®"

```java

#### 8.3.1.3 æ­¥éª¤3ï¼šæ€§èƒ½åˆ†æ

```

æç¤ºè¯æ¨¡æ¿ï¼š
"è¯·åˆ†æä»¥ä¸‹ä»£ç çš„æ€§èƒ½é—®é¢˜ï¼š
[ä»£ç ç‰‡æ®µ]

#### 8.3.1.3 æ­¥éª¤3ï¼šæ€§èƒ½åˆ†æ
39. æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡
40. å†…å­˜ä½¿ç”¨æƒ…å†µ
41. å¹¶å‘å®‰å…¨æ€§
42. ç¼“å­˜ä½¿ç”¨ç­–ç•¥

è¯·æä¾›ï¼š
43. æ€§èƒ½ç“¶é¢ˆåˆ†æ
44. ä¼˜åŒ–å»ºè®®
45. é¢„æœŸæ€§èƒ½æå‡æ•ˆæœ"

```jsx

### 8.2.2 ä»£ç å®¡æŸ¥æ ‡å‡†å’Œæµç¨‹æ¨¡æ¿


**ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•ï¼š**

| æ£€æŸ¥ç±»åˆ« | æ£€æŸ¥é¡¹ç›® | æ£€æŸ¥æ ‡å‡† | ä¸¥é‡ç¨‹åº¦ | æ£€æŸ¥ç»“æœ |
| --------- | --------- | --------- | ---------- | ---------- |
| **ä»£ç è§„èŒƒ** | å‘½åè§„èŒƒ | æ˜¯å¦éµå¾ªé©¼å³°å‘½åæ³•ï¼Œåç§°æ˜¯å¦æœ‰æ„ä¹‰ | ä½ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | ä»£ç æ ¼å¼ | æ˜¯å¦éµå¾ªå›¢é˜Ÿä»£ç æ ¼å¼è§„èŒƒ | ä½ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |

### 8.2.2 ä»£ç å®¡æŸ¥æ ‡å‡†å’Œæµç¨‹æ¨¡æ¿ 2


**ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•ï¼š**

| æ£€æŸ¥ç±»åˆ« | æ£€æŸ¥é¡¹ç›® | æ£€æŸ¥æ ‡å‡† | ä¸¥é‡ç¨‹åº¦ | æ£€æŸ¥ç»“æœ |
| --------- | --------- | --------- | ---------- | ---------- |
| **ä»£ç è§„èŒƒ** | å‘½åè§„èŒƒ | æ˜¯å¦éµå¾ªé©¼å³°å‘½åæ³•ï¼Œåç§°æ˜¯å¦æœ‰æ„ä¹‰ | ä½ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | ä»£ç æ ¼å¼ | æ˜¯å¦éµå¾ªå›¢é˜Ÿä»£ç æ ¼å¼è§„èŒƒ | ä½ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | æ³¨é‡Šè´¨é‡ | å…³é”®é€»è¾‘æ˜¯å¦æœ‰æ¸…æ™°æ³¨é‡Š | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| **è®¾è®¡è´¨é‡** | å•ä¸€èŒè´£ | ç±»å’Œæ–¹æ³•æ˜¯å¦èŒè´£å•ä¸€ | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | å¼€é—­åŸåˆ™ | æ˜¯å¦ä¾¿äºæ‰©å±•ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç  | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | ä¾èµ–å€’ç½® | æ˜¯å¦ä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç° | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| **åŠŸèƒ½æ­£ç¡®æ€§** | ä¸šåŠ¡é€»è¾‘ | æ˜¯å¦æ­£ç¡®å®ç°ä¸šåŠ¡éœ€æ±‚ | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | è¾¹ç•Œæ¡ä»¶ | æ˜¯å¦å¤„ç†è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | é”™è¯¯å¤„ç† | æ˜¯å¦æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†æœºåˆ¶ | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| **å®‰å…¨æ€§** | è¾“å…¥éªŒè¯ | æ˜¯å¦å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯ | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | æƒé™æ§åˆ¶ | æ˜¯å¦æœ‰é€‚å½“çš„æƒé™æ£€æŸ¥ | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | æ•æ„Ÿä¿¡æ¯ | æ˜¯å¦é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ² | é«˜ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| **æ€§èƒ½** | ç®—æ³•æ•ˆç‡ | ç®—æ³•å¤æ‚åº¦æ˜¯å¦åˆç† | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | æ•°æ®åº“æŸ¥è¯¢ | æ˜¯å¦é¿å…N+1æŸ¥è¯¢é—®é¢˜ | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | èµ„æºç®¡ç† | æ˜¯å¦æ­£ç¡®ç®¡ç†èµ„æºï¼ˆè¿æ¥ã€æ–‡ä»¶ç­‰ï¼‰ | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| **å¯æµ‹è¯•æ€§** | å•å…ƒæµ‹è¯• | æ˜¯å¦ç¼–å†™äº†å……åˆ†çš„å•å…ƒæµ‹è¯• | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |
| - | æµ‹è¯•è¦†ç›–ç‡ | æµ‹è¯•è¦†ç›–ç‡æ˜¯å¦è¾¾åˆ°è¦æ±‚ï¼ˆ>80%ï¼‰ | ä¸­ | â–¡é€šè¿‡ â–¡ä¸é€šè¿‡ |

**ä»£ç å®¡æŸ¥æµç¨‹æ¨¡æ¿ï¼š**


<div class="chart-container">
    F --> G{å®¡æŸ¥é€šè¿‡?}
    G -->|å¦| H[æå‡ºä¿®æ”¹æ„è§]
    H --> I[å¼€å‘è€…ä¿®æ”¹ä»£ç ]
    I --> F
    G -->|æ˜¯| J[ä»£ç åˆå¹¶]
    J --> K[éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ]
    K --> L[è‡ªåŠ¨åŒ–æµ‹è¯•]
    L --> M{æµ‹è¯•é€šè¿‡?}
    M -->|å¦| N[å›æ»šä»£ç ]
    N --> H
    M -->|æ˜¯| O[å®¡æŸ¥å®Œæˆ]

```java

**ä»£ç å®¡æŸ¥æŠ¥å‘Šæ¨¡æ¿ï¼š**

```markdown

## ç¬¬8ç«  ä»£ç å®¡æŸ¥æŠ¥å‘Š


## 8.4 åŸºæœ¬ä¿¡æ¯

**ä»£ç å®¡æŸ¥æŠ¥å‘Šæ¨¡æ¿ï¼š**
- **å®¡æŸ¥æ—¥æœŸï¼š** [å®¡æŸ¥æ—¥æœŸ]
- **åˆ†æ”¯/PRï¼š** [åˆ†æ”¯åç§°æˆ–PRç¼–å·]
- **æ¶‰åŠæ–‡ä»¶ï¼š** [æ–‡ä»¶åˆ—è¡¨]

## 8.5 å®¡æŸ¥æ¦‚è¦

- **ä»£ç è¡Œæ•°ï¼š** [æ–°å¢/ä¿®æ”¹/åˆ é™¤è¡Œæ•°]
- **å®¡æŸ¥æ—¶é•¿ï¼š** [å®¡æŸ¥ç”¨æ—¶]
- **æ€»ä½“è¯„ä»·ï¼š** â–¡ä¼˜ç§€ â–¡è‰¯å¥½ â–¡éœ€æ”¹è¿› â–¡ä¸åˆæ ¼

## 8.6 è¯¦ç»†å®¡æŸ¥ç»“æœ


### 8.6.1 ä¼˜ç‚¹

1. [ä»£ç çš„ä¼˜ç‚¹1]
2. [ä»£ç çš„ä¼˜ç‚¹2]

...

### 8.6.2 é—®é¢˜æ¸…å•


#### 8.6.2.1 ä¸¥é‡é—®é¢˜ï¼ˆå¿…é¡»ä¿®å¤ï¼‰

| é—®é¢˜ID | æ–‡ä»¶ä½ç½® | é—®é¢˜æè¿° | ä¿®æ”¹å»ºè®® |
| -------- | ---------- | ---------- | ---------- |
| S001 | UserService.java:45 | [é—®é¢˜æè¿°] | [ä¿®æ”¹å»ºè®®] |
| S002 | OrderController.java:23 | [é—®é¢˜æè¿°] | [ä¿®æ”¹å»ºè®®] |

#### 8.6.2.2 ä¸€èˆ¬é—®é¢˜ï¼ˆå»ºè®®ä¿®å¤ï¼‰

| é—®é¢˜ID | æ–‡ä»¶ä½ç½® | é—®é¢˜æè¿° | ä¿®æ”¹å»ºè®® |
| -------- | ---------- | ---------- | ---------- |
| M001 | UserService.java:67 | [é—®é¢˜æè¿°] | [ä¿®æ”¹å»ºè®®] |
| M002 | OrderService.java:89 | [é—®é¢˜æè¿°] | [ä¿®æ”¹å»ºè®®] |

#### 8.6.2.3 å»ºè®®æ”¹è¿›ï¼ˆå¯é€‰ä¿®å¤ï¼‰

| é—®é¢˜ID | æ–‡ä»¶ä½ç½® | é—®é¢˜æè¿° | ä¿®æ”¹å»ºè®® |
| -------- | ---------- | ---------- | ---------- |
| L001 | UserController.java:12 | [é—®é¢˜æè¿°] | [ä¿®æ”¹å»ºè®®] |

### 8.6.3 æ€§èƒ½åˆ†æ

- **æ½œåœ¨æ€§èƒ½é—®é¢˜ï¼š** [æ€§èƒ½é—®é¢˜æè¿°]
- **ä¼˜åŒ–å»ºè®®ï¼š** [ä¼˜åŒ–å»ºè®®]
- **é¢„æœŸæ”¹è¿›æ•ˆæœï¼š** [æ”¹è¿›æ•ˆæœ]

### 8.6.4 å®‰å…¨æ€§è¯„ä¼°

- **å®‰å…¨é£é™©ç­‰çº§ï¼š** â–¡é«˜ â–¡ä¸­ â–¡ä½
- **ä¸»è¦å®‰å…¨é—®é¢˜ï¼š** [å®‰å…¨é—®é¢˜æè¿°]
- **å®‰å…¨åŠ å›ºå»ºè®®ï¼š** [åŠ å›ºå»ºè®®]

## 8.7 å®¡æŸ¥å†³ç­–

â–¡ **é€šè¿‡** - ä»£ç è´¨é‡è‰¯å¥½ï¼Œå¯ä»¥åˆå¹¶
â–¡ **æ¡ä»¶é€šè¿‡** - ä¿®å¤ä¸¥é‡é—®é¢˜åå¯ä»¥åˆå¹¶
â–¡ **ä¸é€šè¿‡** - éœ€è¦é‡å¤§ä¿®æ”¹åé‡æ–°å®¡æŸ¥

## 8.8 åç»­è¡ŒåŠ¨

- [ ] ä¿®å¤ä¸¥é‡é—®é¢˜
- [ ] ä¿®å¤ä¸€èˆ¬é—®é¢˜
- [ ] æ›´æ–°å•å…ƒæµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£
- [ ] é‡æ–°æäº¤å®¡æŸ¥

## 8.9 å®¡æŸ¥è€…ç­¾å

**å®¡æŸ¥è€…ï¼š** [å®¡æŸ¥è€…å§“å]  
**å®¡æŸ¥æ—¥æœŸï¼š** [æ—¥æœŸ]  
**å®¡æŸ¥ç»“è®ºï¼š** [é€šè¿‡/æ¡ä»¶é€šè¿‡/ä¸é€šè¿‡]

```## 
8.3 ç‰ˆæœ¬æ§åˆ¶é›†æˆ

### 8.3.1 Gitå·¥ä½œæµé…ç½®


**æ¨èçš„Gitåˆ†æ”¯ç­–ç•¥ï¼š**


<div class="chart-container">
```mermaid
gitgraph
    commit id: "Initial"
    branch develop
    checkout develop
    commit id: "Dev setup"
    branch feature/user-auth
    checkout feature/user-auth
    commit id: "Add login"
    commit id: "Add register"
    checkout develop
    merge feature/user-auth
    commit id: "Merge auth"
    branch release/v1.0
    checkout release/v1.0
    commit id: "Release prep"
    commit id: "Bug fixes"
    checkout main
    merge release/v1.0
    commit id: "v1.0 Release"
    tag: "v1.0"
    checkout develop
    merge release/v1.0
    commit id: "Sync release"
```java
**Gité…ç½®æ¨¡æ¿ï¼š**
```bash

## ç¬¬8ç«  .gitconfig å›¢é˜Ÿé…ç½®
[user]
    name = Your Name
    email = your.email@company.com
**Gité…ç½®æ¨¡æ¿ï¼š**
    editor = code --wait
    excludesfile = ~/.gitignore_global
[pull]
    rebase = true
[push]
    default = current
[branch]
    autosetupmerge = always
    autosetuprebase = always

[alias]

    # å¸¸ç”¨åˆ«å
    st = status
    co = checkout
    br = branch
    ci = commit

    df = diff
    lg = log --oneline --graph --decorate --all

    # é«˜çº§åˆ«å

    unstage = reset HEAD --
    last = log -1 HEAD
    visual = !gitk

    # å›¢é˜Ÿåä½œåˆ«å
    sync = !git fetch origin && git rebase origin/develop
    publish = push -u origin HEAD
    cleanup = !git branch --merged | grep -v '\\*\\|main\\|develop' | xargs -n 1 git branch -d
[commit]
    template = ~/.gitmessage
[merge]
    tool = vscode
[mergetool "vscode"]
    cmd = code --wait $MERGED
[diff]
    tool = vscode
[difftool "vscode"]
    cmd = code --wait --diff $LOCAL $REMOTE
```java
**æäº¤ä¿¡æ¯æ¨¡æ¿ï¼š**

```bash

## ç¬¬8ç«  .gitmessage æ¨¡æ¿

## ç¬¬8ç«  <type>(<scope>): <subject>

## ç¬¬8ç«  <body>

**æäº¤ä¿¡æ¯æ¨¡æ¿ï¼š**
# ç¬¬8ç«  <footer>

## ç¬¬8ç«  Type ç±»å‹:

## ç¬¬8ç«  feat: æ–°åŠŸèƒ½

## ç¬¬8ç«  fix: ä¿®å¤bug

## ç¬¬8ç«  docs: æ–‡æ¡£æ›´æ–°

## ç¬¬8ç«  style: ä»£ç æ ¼å¼è°ƒæ•´

## ç¬¬8ç«  refactor: ä»£ç é‡æ„

## ç¬¬8ç«  test: æµ‹è¯•ç›¸å…³

## ç¬¬8ç«  chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

## ç¬¬8ç«  Scope èŒƒå›´:

## ç¬¬8ç«  auth: è®¤è¯æ¨¡å—

## ç¬¬8ç«  user: ç”¨æˆ·æ¨¡å—

## ç¬¬8ç«  order: è®¢å•æ¨¡å—

## ç¬¬8ç«  payment: æ”¯ä»˜æ¨¡å—

## ç¬¬8ç«  Subject ä¸»é¢˜:

## ç¬¬8ç«  ç®€æ´æè¿°æœ¬æ¬¡æäº¤çš„å†…å®¹ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦

## ç¬¬8ç«  ä½¿ç”¨åŠ¨è¯åŸå½¢ï¼Œé¦–å­—æ¯å°å†™ï¼Œç»“å°¾ä¸åŠ å¥å·

## ç¬¬8ç«  Body æ­£æ–‡:

## ç¬¬8ç«  è¯¦ç»†æè¿°æœ¬æ¬¡æäº¤çš„å†…å®¹ï¼Œè§£é‡Šä¸ºä»€ä¹ˆåšè¿™ä¸ªæ”¹åŠ¨

## ç¬¬8ç«  æ¯è¡Œä¸è¶…è¿‡72ä¸ªå­—ç¬¦

## ç¬¬8ç«  Footer é¡µè„š:

## ç¬¬8ç«  å…³è”çš„Issueç¼–å·ï¼Œå¦‚: Closes #e1f5fe

## ç¬¬8ç«  ç ´åæ€§å˜æ›´è¯´æ˜ï¼Œå¦‚: BREAKING CHANGE: xxx

```java
**AIè¾…åŠ©æäº¤ä¿¡æ¯ç”Ÿæˆï¼š**
```

æç¤ºè¯æ¨¡æ¿ï¼š
"åŸºäºä»¥ä¸‹ä»£ç å˜æ›´ï¼Œç”Ÿæˆç¬¦åˆè§„èŒƒçš„Gitæäº¤ä¿¡æ¯ï¼š

å˜æ›´æ–‡ä»¶ï¼š
[æ–‡ä»¶åˆ—è¡¨]

å˜æ›´å†…å®¹ï¼š
[å˜æ›´æè¿°]
**AIè¾…åŠ©æäº¤ä¿¡æ¯ç”Ÿæˆï¼š**
1. ç¬¦åˆçº¦å®šå¼æäº¤è§„èŒƒçš„æäº¤ä¿¡æ¯
2. åŒ…å«é€‚å½“çš„typeå’Œscope
3. ç®€æ´æ˜ç¡®çš„subject
4. å¿…è¦æ—¶åŒ…å«bodyè¯´æ˜"

ç¤ºä¾‹è¾“å‡ºï¼š
feat(auth): add JWT token refresh mechanism

- Implement automatic token refresh before expiration
- Add refresh token storage in Redis
- Update authentication middleware to handle token refresh
- Add unit tests for token refresh logic

Closes #156

```java

### 8.3.2 ç‰ˆæœ¬æ§åˆ¶æœ€ä½³å®è·µ


**åˆ†æ”¯ç®¡ç†ç­–ç•¥ï¼š**

| åˆ†æ”¯ç±»å‹ | å‘½åè§„èŒƒ | ç”¨é€” | ç”Ÿå‘½å‘¨æœŸ |
| --------- | --------- | ------ | ---------- |
| **ä¸»åˆ†æ”¯** | `main` | ç”Ÿäº§ç¯å¢ƒä»£ç  | æ°¸ä¹… |
| **å¼€å‘åˆ†æ”¯** | `develop` | å¼€å‘ç¯å¢ƒä»£ç  | æ°¸ä¹… |
| **åŠŸèƒ½åˆ†æ”¯** | `feature/åŠŸèƒ½å` | æ–°åŠŸèƒ½å¼€å‘ | ä¸´æ—¶ |
| **å‘å¸ƒåˆ†æ”¯** | `release/ç‰ˆæœ¬å·` | ç‰ˆæœ¬å‘å¸ƒå‡†å¤‡ | ä¸´æ—¶ |
| **ä¿®å¤åˆ†æ”¯** | `hotfix/é—®é¢˜æè¿°` | ç´§æ€¥bugä¿®å¤ | ä¸´æ—¶ |
| **å®éªŒåˆ†æ”¯** | `experiment/å®éªŒå` | æŠ€æœ¯éªŒè¯ | ä¸´æ—¶ |
### 8.3.2 ç‰ˆæœ¬æ§åˆ¶æœ€ä½³å®è·µ


**åˆ†æ”¯ç®¡ç†ç­–ç•¥ï¼š**

| åˆ†æ”¯ç±»å‹ | å‘½åè§„èŒƒ | ç”¨é€” | ç”Ÿå‘½å‘¨æœŸ |
| --------- | --------- | ------ | ---------- |
| **ä¸»åˆ†æ”¯** | `main` | ç”Ÿäº§ç¯å¢ƒä»£ç  | æ°¸ä¹… |
| **å¼€å‘åˆ†æ”¯** | `develop` | å¼€å‘ç¯å¢ƒä»£ç  | æ°¸ä¹… |
| **åŠŸèƒ½åˆ†æ”¯** | `feature/åŠŸèƒ½å` | æ–°åŠŸèƒ½å¼€å‘ | ä¸´æ—¶ |
| **å‘å¸ƒåˆ†æ”¯** | `release/ç‰ˆæœ¬å·` | ç‰ˆæœ¬å‘å¸ƒå‡†å¤‡ | ä¸´æ—¶ |
| **ä¿®å¤åˆ†æ”¯** | `hotfix/é—®é¢˜æè¿°` | ç´§æ€¥bugä¿®å¤ | ä¸´æ—¶ |
| **å®éªŒåˆ†æ”¯** | `experiment/å®éªŒå` | æŠ€æœ¯éªŒè¯ | ä¸´æ—¶ |

**ä»£ç åˆå¹¶è§„èŒƒï¼š**
# ç¬¬8ç«  å‘å¸ƒåˆ†æ”¯åˆå¹¶åˆ°main

git checkout main
git pull origin main
git merge --no-ff release/v1.0
git tag -a v1.0 -m "Release version 1.0"
git push origin main --tags

# ç¬¬8ç«  åŒæ­¥å‘å¸ƒåˆ†æ”¯åˆ°develop

git checkout develop
git merge --no-ff release/v1.0
git push origin develop
git branch -d release/v1.0

```java

**å†²çªè§£å†³æµç¨‹ï¼š**

```bash

# ç¬¬8ç«  1. æ›´æ–°æœ¬åœ°åˆ†æ”¯

git fetch origin
git checkout feature/my-feature
git rebase origin/develop

# ç¬¬8ç«  2. è§£å†³å†²çª

# ç¬¬8ç«  ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œè§£å†³å†²çªæ ‡è®°

**å†²çªè§£å†³æµç¨‹ï¼š**

# ç¬¬8ç«  3. éªŒè¯è§£å†³ç»“æœ

git log --oneline --graph
git diff origin/develop

# ç¬¬8ç«  4. æ¨é€è§£å†³åçš„åˆ†æ”¯

git push --force-with-lease origin feature/my-feature

```java

### 8.3.3 CI/CDé›†æˆé…ç½®


**GitHub Actionsé…ç½®ï¼š**

```yaml

# ç¬¬8ç«  .github/workflows/ci.yml

name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
### 8.3.3 CI/CDé›†æˆé…ç½®


**GitHub Actionsé…ç½®ï¼š**
    
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_ROOT_PASSWORD: root
          MYSQL_DATABASE: testdb
        ports:
          - 3306:3306

        options: --health-cmd="mysqladmin ping" --health-interval=10s --health-timeout=5s --health-retries=3
      
      redis:
        image: redis:6.2
        ports:
          - 6379:6379

        options: --health-cmd="redis-cli ping" --health-interval=10s --health-timeout=5s --health-retries=3
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 11

      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Cache Maven dependencies

      uses: actions/cache@v3
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
        restore-keys: ${{ runner.os }}-m2
    
    - name: Run tests

      run: |
        mvn clean test
        mvn jacoco:report
    
    - name: Upload coverage to Codecov

      uses: codecov/codecov-action@v3
      with:
        file: ./target/site/jacoco/jacoco.xml
    
    - name: SonarQube Scan

      uses: sonarqube-quality-gate-action@master
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}

  build:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 11

      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Build application

      run: mvn clean package -DskipTests
    
    - name: Build Docker image

      run: |
        docker build -t myapp:${{ github.sha }} .
        docker tag myapp:${{ github.sha }} myapp:latest
    
    - name: Push to registry

run: |
| echo ${{ secrets.DOCKER_PASSWORD }} |
        docker push myapp:${{ github.sha }}
        docker push myapp:latest

  deploy:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - name: Deploy to staging

      run: |
        # éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒçš„è„šæœ¬
        echo "Deploying to staging environment"
    
    - name: Run integration tests

      run: |
        # è¿è¡Œé›†æˆæµ‹è¯•çš„è„šæœ¬
        echo "Running integration tests"
    
    - name: Deploy to production

      if: success()
      run: |
        # éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„è„šæœ¬
        echo "Deploying to production environment"

```java

**ä»£ç è´¨é‡æ£€æŸ¥é…ç½®ï¼š**

```yaml

# ç¬¬8ç«  .github/workflows/code-quality.yml

name: Code Quality

on:
  pull_request:
    branches: [ main, develop ]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    
**ä»£ç è´¨é‡æ£€æŸ¥é…ç½®ï¼š**

      with:
        fetch-depth: 0
    
    - name: Set up JDK 11

      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Run Checkstyle

      run: mvn checkstyle:check
    
    - name: Run PMD

      run: mvn pmd:check
    
    - name: Run SpotBugs

      run: mvn spotbugs:check
    
    - name: Run dependency check

      run: mvn org.owasp:dependency-check-maven:check
    
    - name: Comment PR

      uses: actions/github-script@v6
      if: failure()
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: 'âŒ ä»£ç è´¨é‡æ£€æŸ¥å¤±è´¥ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Šå¹¶ä¿®å¤é—®é¢˜ã€‚'
          })

```jsx

## 8.4 å›¢é˜Ÿåä½œæœ€ä½³å®è·µ


### 8.4.1 å¼€å‘æµç¨‹è§„èŒƒ


**æ•æ·å¼€å‘æµç¨‹ï¼š**


<div class="chart-container">
```mermaid
graph TD
    A[Sprintè®¡åˆ’] --> B[ä»»åŠ¡åˆ†è§£]
    B --> C[å¼€å‘ä»»åŠ¡åˆ†é…]
    C --> D[åŠŸèƒ½åˆ†æ”¯å¼€å‘]
    D --> E[ä»£ç å®¡æŸ¥]
## 8.4 å›¢é˜Ÿåä½œæœ€ä½³å®è·µ
### 8.4.1 å¼€å‘æµç¨‹è§„èŒƒ
**æ•æ·å¼€å‘æµç¨‹ï¼š**
<div class="chart-container">
    M --> N{éªŒæ”¶é€šè¿‡?}
    N -->|å¦| O[éœ€æ±‚æ¾„æ¸…]
    O --> D
    N -->|æ˜¯| P[Sprintå›é¡¾]
    P --> Q[å‘å¸ƒè®¡åˆ’]
```java
**ä»»åŠ¡ç®¡ç†æ¨¡æ¿ï¼š**
```markdown
# ç¬¬8ç«  ç”¨æˆ·æ•…äº‹å¡ç‰‡æ¨¡æ¿
## 8.11 åŸºæœ¬ä¿¡æ¯
- **æ•…äº‹IDï¼š** US-001
- **æ•…äº‹æ ‡é¢˜ï¼š** ç”¨æˆ·ç™»å½•åŠŸèƒ½
- **è´Ÿè´£äººï¼š** å¼ ä¸‰
- **ä¼˜å…ˆçº§ï¼š** é«˜
- **æ•…äº‹ç‚¹ï¼š** 5
- **Sprintï¼š** Sprint 1

## 8.12 ç”¨æˆ·æ•…äº‹
**ä»»åŠ¡ç®¡ç†æ¨¡æ¿ï¼š**
## 8.13 éªŒæ”¶æ ‡å‡†
52. GIVEN ç”¨æˆ·åœ¨ç™»å½•é¡µé¢ WHEN è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç  THEN ç³»ç»Ÿåº”è¯¥éªŒè¯ç”¨æˆ·èº«ä»½å¹¶è·³è½¬åˆ°é¦–é¡µ
53. GIVEN ç”¨æˆ·è¾“å…¥é”™è¯¯çš„ç”¨æˆ·åæˆ–å¯†ç  WHEN ç‚¹å‡»ç™»å½•æŒ‰é’® THEN ç³»ç»Ÿåº”è¯¥æ˜¾ç¤ºé”™è¯¯æç¤ºä¿¡æ¯
54. GIVEN ç”¨æˆ·è¿ç»­3æ¬¡è¾“å…¥é”™è¯¯å¯†ç  WHEN ç¬¬3æ¬¡ç™»å½•å¤±è´¥ THEN ç³»ç»Ÿåº”è¯¥é”å®šè´¦æˆ·5åˆ†é’Ÿ
## 8.14 æŠ€æœ¯ä»»åŠ¡
- [ ] è®¾è®¡ç™»å½•é¡µé¢UI
- [ ] å®ç°ç”¨æˆ·è®¤è¯API
- [ ] æ·»åŠ å¯†ç åŠ å¯†åŠŸèƒ½
- [ ] å®ç°è´¦æˆ·é”å®šæœºåˆ¶
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] ç¼–å†™é›†æˆæµ‹è¯•
## 8.15 å®šä¹‰å®Œæˆ
- [ ] ä»£ç å¼€å‘å®Œæˆ
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆè¦†ç›–ç‡>80%ï¼‰
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] ç”¨æˆ·éªŒæ”¶æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ
## 8.16 ä¾èµ–é¡¹
- ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ï¼ˆUS-002ï¼‰
- æ•°æ®åº“ç”¨æˆ·è¡¨è®¾è®¡
## 8.17 é£é™©å’Œé—®é¢˜
- ç¬¬ä¸‰æ–¹è®¤è¯æœåŠ¡å¯èƒ½ä¸ç¨³å®š
- å¯†ç åŠ å¯†ç®—æ³•éœ€è¦å®‰å…¨è¯„ä¼°
## 8.18 å¤‡æ³¨
- éœ€è¦æ”¯æŒè®°ä½ç™»å½•çŠ¶æ€åŠŸèƒ½
- è€ƒè™‘æ·»åŠ éªŒè¯ç é˜²æ­¢æš´åŠ›ç ´è§£
```java
### 8.4.2 æ²Ÿé€šåä½œå·¥å…·é…ç½®

**Slacké›†æˆé…ç½®ï¼š**
```yaml
# ç¬¬8ç«  .github/workflows/slack-notification.yml
name: Slack Notifications
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_run:
    workflows: ["CI/CD Pipeline"]
### 8.4.2 æ²Ÿé€šåä½œå·¥å…·é…ç½®
**Slacké›†æˆé…ç½®ï¼š**
    runs-on: ubuntu-latest
    steps:
    - name: Notify deployment success
      if: github.event.workflow_run.conclusion == 'success'
      uses: 8398a7/action-slack@v3
      with:
        status: success
        channel: '#e1f5fe'

        text: |
          ğŸš€ éƒ¨ç½²æˆåŠŸï¼
          åˆ†æ”¯: ${{ github.ref }}
          æäº¤: ${{ github.sha }}
          ä½œè€…: ${{ github.actor }}
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
    - name: Notify deployment failure
      if: github.event.workflow_run.conclusion == 'failure'
      uses: 8398a7/action-slack@v3
      with:
        status: failure
        channel: '#e1f5fe'
        text: |
          âŒ éƒ¨ç½²å¤±è´¥ï¼
          åˆ†æ”¯: ${{ github.ref }}
          æäº¤: ${{ github.sha }}
          ä½œè€…: ${{ github.actor }}
          è¯·æ£€æŸ¥æ„å»ºæ—¥å¿—: ${{ github.event.workflow_run...}}
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
```java
**å›¢é˜Ÿåä½œè§„èŒƒï¼š**
| åä½œåœºæ™¯ | å·¥å…·é€‰æ‹© | ä½¿ç”¨è§„èŒƒ | å“åº”æ—¶é—´ |
| --------- | --------- | --------- | ---------- |
| **æ—¥å¸¸æ²Ÿé€š** | Slack/ä¼ä¸šå¾®ä¿¡ | ä½¿ç”¨é¢‘é“åˆ†ç±»è®¨è®ºï¼Œé‡è¦ä¿¡æ¯ç½®é¡¶ | 2å°æ—¶å†… |
| **ä»£ç å®¡æŸ¥** | GitHub/GitLab | è¯¦ç»†çš„å®¡æŸ¥æ„è§ï¼Œå»ºè®¾æ€§åé¦ˆ | 24å°æ—¶å†… |
| **é—®é¢˜è·Ÿè¸ª** | Jira/GitHub Issues | æ¸…æ™°çš„é—®é¢˜æè¿°ï¼ŒåŠæ—¶çŠ¶æ€æ›´æ–° | 4å°æ—¶å†… |
| **æ–‡æ¡£åä½œ** | Confluence/Notion | ç‰ˆæœ¬æ§åˆ¶ï¼Œå®šæœŸæ›´æ–° | 48å°æ—¶å†… |
| **ä¼šè®®å®‰æ’** | æ—¥å†ç³»ç»Ÿ | æå‰é€šçŸ¥ï¼Œå‡†å¤‡è®®ç¨‹ | æå‰24å°æ—¶ |
| **ç´§æ€¥é—®é¢˜** | ç”µè¯/å³æ—¶æ¶ˆæ¯ | ç«‹å³å“åº”ï¼Œå‡çº§æœºåˆ¶ | 30åˆ†é’Ÿå†… |
### 8.4.3 çŸ¥è¯†ç®¡ç†å’Œæ–‡æ¡£è§„èŒƒ

**æŠ€æœ¯æ–‡æ¡£æ¨¡æ¿ï¼š**
```markdown
# ç¬¬8ç«  [åŠŸèƒ½æ¨¡å—]æŠ€æœ¯æ–‡æ¡£
**å›¢é˜Ÿåä½œè§„èŒƒï¼š**
| åä½œåœºæ™¯ | å·¥å…·é€‰æ‹© | ä½¿ç”¨è§„èŒƒ | å“åº”æ—¶é—´ |
| --------- | --------- | --------- | ---------- |
| **æ—¥å¸¸æ²Ÿé€š** | Slack/ä¼ä¸šå¾®ä¿¡ | ä½¿ç”¨é¢‘é“åˆ†ç±»è®¨è®ºï¼Œé‡è¦ä¿¡æ¯ç½®é¡¶ | 2å°æ—¶å†… |
| **ä»£ç å®¡æŸ¥** | GitHub/GitLab | è¯¦ç»†çš„å®¡æŸ¥æ„è§ï¼Œå»ºè®¾æ€§åé¦ˆ | 24å°æ—¶å†… |
| **é—®é¢˜è·Ÿè¸ª** | Jira/GitHub Issues | æ¸…æ™°çš„é—®é¢˜æè¿°ï¼ŒåŠæ—¶çŠ¶æ€æ›´æ–° | 4å°æ—¶å†… |
| **æ–‡æ¡£åä½œ** | Confluence/Notion | ç‰ˆæœ¬æ§åˆ¶ï¼Œå®šæœŸæ›´æ–° | 48å°æ—¶å†… |
| **ä¼šè®®å®‰æ’** | æ—¥å†ç³»ç»Ÿ | æå‰é€šçŸ¥ï¼Œå‡†å¤‡è®®ç¨‹ | æå‰24å°æ—¶ |
| **ç´§æ€¥é—®é¢˜** | ç”µè¯/å³æ—¶æ¶ˆæ¯ | ç«‹å³å“åº”ï¼Œå‡çº§æœºåˆ¶ | 30åˆ†é’Ÿå†… |
### 8.4.3 çŸ¥è¯†ç®¡ç†å’Œæ–‡æ¡£è§„èŒƒ
**æŠ€æœ¯æ–‡æ¡£æ¨¡æ¿ï¼š**
### 8.21.1 æ•´ä½“æ¶æ„
[æ¶æ„å›¾å’Œè¯´æ˜]
### 8.21.2 æ ¸å¿ƒç»„ä»¶
| ç»„ä»¶åç§° | èŒè´£ | æŠ€æœ¯æ ˆ | æ¥å£ |
| --------- | ------ | -------- | ------ |
| [ç»„ä»¶1] | [èŒè´£æè¿°] | [æŠ€æœ¯æ ˆ] | [æ¥å£è¯´æ˜] |
| [ç»„ä»¶2] | [èŒè´£æè¿°] | [æŠ€æœ¯æ ˆ] | [æ¥å£è¯´æ˜] |
## 8.22 APIæ–‡æ¡£
### 8.22.1 æ¥å£åˆ—è¡¨
| æ¥å£åç§° | æ–¹æ³• | è·¯å¾„ | æè¿° |
| --------- | ------ | ------ | ------ |
| [æ¥å£1] | POST | /api/v1/users | [æè¿°] |
| [æ¥å£2] | GET | /api/v1/users/{id} | [æè¿°] |
### 8.22.2 æ¥å£è¯¦æƒ…
#### 8.22.2.1 åˆ›å»ºç”¨æˆ·
```http
POST /api/v1/users
Content-Type: application/json
{
  "username": "string",
  "email": "string",
  "password": "string"
}
%% Standard styling
classDef default fill:#e1f5fe,stroke:#333,stroke-width:2px
classDef highlight fill:#bbdefb,stroke:#333,stroke-width:3px
classDef process fill:#90caf9,stroke:#333,stroke-width:2px
classDef decision fill:#64b5f6,stroke:#333,stroke-width:2px
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "username": "testuser",
    "email": "test@example.com",
POST /api/v1/users
Content-Type: application/json

{
  "username": "string",
  "email": "string",
  "password": "string"
}
### 8.23.1 è¡¨ç»“æ„


```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "username": "testuser",
    "email": "test@example.com",
    "createdTime": "2024-01-15T10:30:00Z"
  }
}
### 8.24.1 ç¯å¢ƒè¦æ±‚

- Java 11+
- MySQL 8.0+
- Redis 6.0+

### 8.24.2 é…ç½®æ–‡ä»¶

CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    created_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
  redis:
    host: ${REDIS_HOST}
    port: ${REDIS_PORT}

```

### 8.24.3 éƒ¨ç½²æ­¥éª¤

1. æ„å»ºåº”ç”¨ï¼š`mvn clean package`
2. æ„å»ºé•œåƒï¼š`docker build -t myapp .`
3. å¯åŠ¨æœåŠ¡ï¼š`docker-compose up -d`

## 8.25 ç›‘æ§å’Œè¿ç»´

# ç¬¬8ç«  application.yml

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/myapp
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  redis:
    host: ${REDIS_HOST}
    port: ${REDIS_PORT}
<configuration>
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <logger name="com.example.myapp" level="INFO"/>
    <root level="WARN">
        <appender-ref ref="STDOUT"/>
    </root>
</configuration>

```

## 8.26 å¸¸è§é—®é¢˜

### 8.26.1 Q1: å¦‚ä½•å¤„ç†æ•°æ®åº“è¿æ¥è¶…æ—¶ï¼Ÿ

A1: æ£€æŸ¥æ•°æ®åº“è¿æ¥æ± é…ç½®ï¼Œå¢åŠ è¿æ¥è¶…æ—¶æ—¶é—´ã€‚
<!-- logback-spring.xml -->
<configuration>
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <logger name="com.example.myapp" level="INFO"/>
    <root level="WARN">
        <appender-ref ref="STDOUT"/>
    </root>
</configuration>

é€šè¿‡è¿™äº›ä¼˜åŒ–çš„å¼€å‘ç®¡ç†å®è·µï¼Œå›¢é˜Ÿå¯ä»¥å»ºç«‹é«˜æ•ˆçš„å¼€å‘æµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œé¡¹ç›®æˆåŠŸäº¤ä»˜ã€‚
```

é€šè¿‡è¿™äº›ä¼˜åŒ–çš„å¼€å‘ç®¡ç†å®è·µï¼Œå›¢é˜Ÿå¯ä»¥å»ºç«‹é«˜æ•ˆçš„å¼€å‘æµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œé¡¹ç›®æˆåŠŸäº¤ä»˜ã€‚