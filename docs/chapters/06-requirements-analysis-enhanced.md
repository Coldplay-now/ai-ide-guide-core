# 第6章 6. 软件需求分析（优化版）


## 6.1 需求收集


### 6.1.1 AI辅助需求收集操作步骤


#### 6.1.1.1 步骤1：项目初始化和上下文设置

```html

提示词模板：
"我正在开始一个新的软件项目：[项目名称]。项目背景是：[项目背景描述]。
目标用户群体是：[用户群体]。请帮我建立项目的需求收集框架。"

```

**操作流程：**

1. 在AI IDE中创建新的需求文档
2. 使用上述提示词模板，填入具体项目信息
3. AI将生成初始的需求收集框架和建议的收集方法

#### 6.1.1.2 步骤2：用户故事自动生成

```html

提示词模板：
"基于以下功能描述，请生成标准的用户故事：
功能描述：[具体功能描述]
涉及角色：[用户角色列表]
业务价值：[预期业务价值]

请使用'作为...我希望...以便...'的格式，并为每个用户故事生成对应的验收标准。"

```

#### 6.1.1.3 步骤3：需求模板库应用

AI IDE内置多种需求模板，可根据项目类型自动选择：

**Web应用需求模板：**

- 用户管理需求模板
- 数据管理需求模板
- 界面交互需求模板
- 安全性需求模板

**移动应用需求模板：**

- 离线功能需求模板
- 推送通知需求模板
- 设备集成需求模板
- 性能优化需求模板

### 6.1.2 实践案例：电商平台需求收集


**项目背景：** 某中小企业需要开发一个B2C电商平台，支持商品展示、购物车、订单管理等核心功能。

**AI辅助需求收集过程：**

**第一步：项目上下文建立**

```markdown

输入提示词：
"我正在开发一个B2C电商平台项目。目标是为中小企业提供完整的在线销售解决方案。
主要用户包括：商家管理员、普通消费者、客服人员。
核心业务流程包括：商品管理、订单处理、支付结算、物流跟踪。
请帮我建立需求收集框架。"

AI输出：
项目需求收集框架已建立：
4. 用户角色分析
   - 商家管理员：商品管理、订单处理、数据分析
   - 普通消费者：浏览购买、订单查询、售后服务
   - 客服人员：订单协助、问题处理、用户沟通

5. 功能模块划分
   - 商品管理模块
   - 用户管理模块
   - 订单管理模块
   - 支付管理模块
   - 物流管理模块

6. 建议的需求收集方法
   - 用户访谈（重点关注业务流程）
   - 竞品分析（参考主流电商平台）
   - 原型验证（关键交互流程）

**第二步：核心用户故事生成**

```html

输入提示词：
"基于电商平台的商品管理功能，请生成详细的用户故事。
输入提示词：
"基于电商平台的商品管理功能，请生成详细的用户故事。
功能描述：商家需要能够添加、编辑、删除商品，设置价格和库存，管理商品分类。
涉及角色：商家管理员
业务价值：提高商品管理效率，确保商品信息准确性"

AI输出：
用户故事1：商品基础管理
作为商家管理员，我希望能够添加新商品并设置基本信息，以便向客户展示我的产品。

验收标准：

1. WHEN 管理员点击"添加商品"按钮 THEN 系统 SHALL 显示商品信息录入表单
2. WHEN 管理员填写商品名称、描述、价格等必填信息 THEN 系统 SHALL 验证信息格式的正确性
3. WHEN 管理员上传商品图片 THEN 系统 SHALL 支持多张图片上传并自动压缩优化
4. WHEN 管理员保存商品信息 THEN 系统 SHALL 将商品添加到商品库并分配唯一ID
5. WHEN 商品保存成功 THEN 系统 SHALL 显示成功提示并跳转到商品列表页面

用户故事2：库存管理
作为商家管理员，我希望能够实时管理商品库存，以便避免超卖情况。

验收标准：


1. WHEN 管理员查看商品详情 THEN 系统 SHALL 显示当前库存数量和库存状态
2. WHEN 管理员修改库存数量 THEN 系统 SHALL 记录库存变更历史
3. WHEN 库存数量低于预设阈值 THEN 系统 SHALL 发送库存预警通知
4. WHEN 库存为零 THEN 系统 SHALL 自动将商品状态设置为"缺货"
5. WHEN 有新订单产生 THEN 系统 SHALL 自动扣减对应商品库存

### 6.1.3 需求收集检查清单


**AI生成的需求收集质量检查清单：**

| 检查项目         | 检查标准                           | 完成状态 |
| ---------------- | ---------------------------------- | -------- |
| 用户角色完整性   | 是否识别了所有关键用户角色         | □        |
| 功能覆盖完整性   | 是否覆盖了所有核心业务流程         | □        |
| 用户故事格式规范 | 是否使用标准的用户故事格式         | □        |
| 验收标准明确性   | 每个用户故事是否有明确的验收标准   | □        |
| 非功能需求识别   | 是否考虑了性能、安全、可用性等需求 | □        |
| 约束条件明确     | 是否明确了技术、时间、预算等约束   | □        |
| 优先级排序       | 是否对需求进行了优先级排序         | □        |
| 可测试性         | 需求是否可以被测试验证             | □        |

## 6.2 需求分析与建模


### 6.2.1 AI辅助需求分析操作步骤


#### 6.2.1.1 步骤1：需求结构化处理

```html

提示词模板：
"请将以下自然语言需求转换为结构化的需求模型：
原始需求：[需求描述]
提示词模板：
"请将以下自然语言需求转换为结构化的需求模型：
原始需求：[需求描述]
请输出：
17. 功能需求分解
18. 非功能需求识别
19. 约束条件提取
20. 依赖关系分析"

```html

提示词模板：
"分析以下需求列表中的关系：
需求列表：[需求1, 需求2, 需求3...]
请识别：
提示词模板：
"分析以下需求列表中的关系：

需求列表：[需求1, 需求2, 需求3...]

请识别：
1. 依赖关系（A依赖B）
2. 冲突关系（A与B冲突）
3. 包含关系（A包含B）
4. 互斥关系（A与B互斥）"
```html

提示词模板：
"基于以下需求信息，生成用例图的Mermaid代码：
参与者：[参与者列表]
用例：[用例列表]
关系：[用例间关系]"
提示词模板：
"基于以下需求信息，生成用例图的Mermaid代码：
参与者：[参与者列表]
用例：[用例列表]
关系：[用例间关系]"
**项目背景：** 开发一个在线学习平台，支持课程管理、学习跟踪、考试评估等功能。

**AI辅助需求分析过程：**

**第一步：需求结构化处理**

```python

输入提示词：
"请将以下需求转换为结构化模型：
原始需求：学生可以浏览课程目录，选择感兴趣的课程进行学习，系统需要记录学习进度，
支持在线考试，并生成学习报告。教师可以创建和管理课程内容。"

AI输出：
输入提示词：
"请将以下需求转换为结构化模型：
原始需求：学生可以浏览课程目录，选择感兴趣的课程进行学习，系统需要记录学习进度，
支持在线考试，并生成学习报告。教师可以创建和管理课程内容。"

AI输出：

功能需求分解：
1. 课程管理功能
   1.1 课程浏览（学生）
   1.2 课程创建（教师）
   1.3 课程编辑（教师）
   1.4 课程发布（教师）

1. 学习管理功能
   2.1 课程选择（学生）
   2.2 学习进度跟踪（系统）
   2.3 学习记录保存（系统）

1. 考试管理功能
   3.1 在线考试（学生）
   3.2 试题管理（教师）
   3.3 成绩统计（系统）

1. 报告管理功能
   4.1 学习报告生成（系统）
   4.2 报告查看（学生、教师）

非功能需求识别：
1. 性能需求：支持1000并发用户
2. 可用性需求：系统可用性99.9%
3. 安全需求：用户数据加密存储
4. 兼容性需求：支持主流浏览器

约束条件：

1. 技术约束：使用React前端框架
2. 时间约束：6个月内完成开发
3. 预算约束：开发成本不超过50万

依赖关系分析：
1. 学习进度跟踪依赖于课程选择
2. 在线考试依赖于课程学习完成
3. 学习报告依赖于学习记录和考试成绩
输入提示词：
"基于在线学习平台的需求，生成用例图的Mermaid代码"

AI输出：


<div class="chart-container">
输入提示词：
"基于在线学习平台的需求，生成用例图的Mermaid代码"

AI输出：


<div class="chart-container">
    Student --> UC1[浏览课程]
    Student --> UC2[选择课程]
    Student --> UC3[学习课程]
    Student --> UC4[参加考试]
    Student --> UC5[查看学习报告]
    
    Teacher --> UC6[创建课程]
    Teacher --> UC7[编辑课程]
    Teacher --> UC8[管理试题]
    Teacher --> UC9[查看学生进度]
    
    Admin --> UC10[用户管理]
    Admin --> UC11[系统配置]
    
    UC3 --> UC2
    UC4 --> UC3
    UC5 --> UC3
    UC5 --> UC4

```html

### 6.2.3 需求模型验证


**AI辅助需求验证检查清单：**

| 验证维度 | 检查项目 | 验证方法 | 状态 |
| -------- | -------- | -------- | ---- |
### 6.2.3 需求模型验证


**AI辅助需求验证检查清单：**

| 验证维度 | 检查项目             | 验证方法     | 状态 |
| -------- | -------------------- | ------------ | ---- |
| 完整性   | 是否覆盖所有业务场景 | 业务流程对比 | □    |
| 一致性   | 需求间是否存在矛盾   | 逻辑关系检查 | □    |
| 可行性   | 技术实现是否可行     | 技术评估     | □    |
| 可测试性 | 需求是否可验证       | 测试用例设计 | □    |
| 可追溯性 | 需求来源是否明确     | 需求溯源检查 | □    |

## 6.3 需求验证


### 6.3.1 AI辅助需求验证操作步骤


#### 6.3.1.1 步骤1：一致性自动检查
[需求3描述]
...

请分析：
39. 逻辑冲突
40. 数据冲突
41. 接口冲突
42. 业务流程冲突"

```html

#### 6.3.1.2 步骤2：原型快速生成

```

提示词模板：
"基于以下需求生成可交互原型的HTML代码：
需求描述：[具体需求]
界面要求：[界面布局要求]
#### 6.3.1.2 步骤2：原型快速生成
请生成包含基本样式和交互逻辑的HTML原型。"

```html

#### 6.3.1.3 步骤3：需求评审报告生成

```

提示词模板：
"生成需求评审报告，包含以下内容：
评审的需求：[需求列表]
评审标准：[评审标准]
发现的问题：[问题列表]
#### 6.3.1.3 步骤3：需求评审报告生成
43. 评审概要
44. 需求质量评估
45. 发现的问题及建议
46. 后续行动计划"

```html

### 6.3.2 实践案例：CRM系统需求验证


**项目背景：** 为销售团队开发CRM系统，管理客户信息、销售机会、合同等。

**AI辅助需求验证过程：**

**第一步：需求一致性检查**

```
### 6.3.2 实践案例：CRM系统需求验证


**项目背景：** 为销售团队开发CRM系统，管理客户信息、销售机会、合同等。

**AI辅助需求验证过程：**

**第一步：需求一致性检查**
AI输出：
一致性检查结果：

✅ 无逻辑冲突：
- 需求1、3、4形成完整的客户信息管理流程
- 需求2与需求1配合，确保数据质量
- 需求5与需求4配合，保证数据完整性

⚠️ 需要澄清的问题：
47. 需求4与需求5的边界：修改权限的范围是什么？
48. 需求2的重复判断标准：基于哪些字段判断重复？
49. 需求5的"无效"状态：是否影响相关销售机会和合同？

💡 改进建议：
50. 明确客户信息修改的权限控制
51. 定义客户重复性检查的具体规则
52. 规定无效客户对关联数据的影响规则

```html

**第二步：原型生成验证**

```

输入提示词：
"为CRM系统的客户信息管理功能生成可交互原型"

AI输出：

```html
<!DOCTYPE html>
**第二步：原型生成验证**
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM客户管理原型</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM客户管理原型</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .customer-list { margin-top: 30px; }
        .customer-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 4px; }
        .duplicate-warning { color: red; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>客户信息管理</h1>
        
        <form id="customerForm">
            <div class="form-group">
                <label for="companyName">公司名称 *</label>
                <input type="text" id="companyName" name="companyName" required>
                <div id="duplicateWarning" class="duplicate-warning" style="display: none;">
                    警告：可能存在重复客户信息
                </div>
            </div>
            
            <div class="form-group">
                <label for="contactName">联系人姓名 *</label>
                <input type="text" id="contactName" name="contactName" required>
            </div>
            
            <div class="form-group">
                <label for="phone">联系电话 *</label>
                <input type="tel" id="phone" name="phone" required>
            </div>
            
            <div class="form-group">
                <label for="email">邮箱地址</label>
                <input type="email" id="email" name="email">
            </div>
            
            <div class="form-group">
                <label for="address">公司地址</label>
                <textarea id="address" name="address" rows="3"></textarea>
            </div>
            
            <button type="submit">保存客户信息</button>
            <button type="button" onclick="resetForm()">重置</button>
        </form>
        
        <div class="customer-list">
            <h2>客户列表</h2>
            <div id="customerItems">
                <div class="customer-item">
                    <strong>客户编号：</strong> CUS001<br>
                    <strong>公司名称：</strong> 示例科技有限公司<br>
                    <strong>联系人：</strong> 张三<br>
                    <strong>电话：</strong> 138-0000-0000<br>
                    <strong>状态：</strong> 有效
                    <button onclick="editCustomer('CUS001')" style="margin-left: 10px;">编辑</button>
                    <button onclick="deactivateCustomer('CUS001')" style="margin-left: 5px;">标记无效</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 模拟重复检查
        document.getElementById('companyName').addEventListener('blur', function() {
            const companyName = this.value.toLowerCase();
            const warning = document.getElementById('duplicateWarning');
            
            // 模拟检查逻辑
            if (companyName.includes('示例') || companyName.includes('测试')) {
                warning.style.display = 'block';
            } else {
                warning.style.display = 'none';
            }
        });
        
        // 表单提交处理
        document.getElementById('customerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('客户信息已保存，系统自动分配客户编号：CUS' + String(Math.floor(Math.random() * 1000)).padStart(3, '0'));
        });
        
        function resetForm() {
            document.getElementById('customerForm').reset();
            document.getElementById('duplicateWarning').style.display = 'none';
        }
        
        function editCustomer(customerId) {
            alert('编辑客户：' + customerId);
        }
        
        function deactivateCustomer(customerId) {
            if (confirm('确定要将客户 ' + customerId + ' 标记为无效吗？')) {
                alert('客户已标记为无效');
            }
        }
    </script>
</body>
</html>
| **需求变更管理** | 手动跟踪变更，版本管理复杂 | AI辅助变更影响分析 | AI简化变更管理流程 |
| **质量保证** | 依赖评审会议和专家经验 | AI+人工双重保障 | 结合方式提供更好保障 |
| **成本投入** | 人力成本高，时间成本大 | 初期工具投入，长期成本降低 | AI方法长期成本优势明显 |

**传统方法的优势保留：**
- 深度业务理解和创新思维
- 复杂业务场景的判断能力
- 利益相关者的沟通协调

**AI方法的突出优势：**
- 自动化程度高，减少重复劳动
- 标准化程度高，确保质量一致性
- 快速迭代能力，支持敏捷开发

**最佳实践建议：**

采用"AI辅助+人工决策"的混合模式，发挥各自优势：
1. 使用AI进行需求收集和初步分析
2. 人工进行业务逻辑验证和创新设计
3. AI辅助进行一致性检查和文档生成
4. 人工进行最终的需求评审和确认

## 6.4 需求管理模板库


### 6.4.1 用户故事模板


**基础用户故事模板：**

```html

标题：[功能名称]
作为：[用户角色]
我希望：[期望功能]
以便：[业务价值]

验收标准：
57. GIVEN [前置条件] WHEN [触发事件] THEN [预期结果] SHALL [系统行为]
58. GIVEN [前置条件] WHEN [触发事件] THEN [预期结果] SHALL [系统行为]

...

优先级：[高/中/低]
标题：[功能名称]
作为：[用户角色]
我希望：[期望功能]
以便：[业务价值]

验收标准：
57. GIVEN [前置条件] WHEN [触发事件] THEN [预期结果] SHALL [系统行为]
58. GIVEN [前置条件] WHEN [触发事件] THEN [预期结果] SHALL [系统行为]

...

优先级：[高/中/低]
估算工作量：[故事点]
依赖项：[相关用户故事]
用户角色：
- 主要角色：[角色名称及描述]
- 次要角色：[角色名称及描述]

功能描述：
作为 [用户角色]，我希望 [期望功能]，以便 [业务价值]

史诗：[史诗名称]
用户故事：[故事标题]

背景：
[业务背景和上下文描述]

用户角色：
- 主要角色：[角色名称及描述]
- 次要角色：[角色名称及描述]

功能描述：
作为 [用户角色]，我希望 [期望功能]，以便 [业务价值]

详细需求：
59. [具体需求1]
60. [具体需求2]

...

验收标准：
场景1：[场景名称]
- GIVEN [前置条件]
- WHEN [用户操作]
- THEN [系统响应]
- AND [附加条件]

场景2：[场景名称]
- GIVEN [前置条件]
- WHEN [用户操作]
- THEN [系统响应]

非功能需求：
- 性能要求：[具体指标]
- 安全要求：[安全标准]
- 可用性要求：[可用性标准]

约束条件：
- 技术约束：[技术限制]
- 业务约束：[业务限制]
- 时间约束：[时间要求]

测试策略：
- 单元测试：[测试范围]
- 集成测试：[测试范围]
- 用户验收测试：[测试场景]

定义完成：
□ 开发完成
□ 代码审查通过
□ 单元测试通过
□ 集成测试通过
□ 用户验收测试通过
□ 文档更新完成
| -   | 业务逻辑正确性 | 业务流程是否符合实际业务 | □通过 □不通过 |
| --- |技术可行性 | 技术实现是否可行 | □通过 □不通过 |
| **一致性** | 内部一致性 | 需求间是否存在冲突 | □通过 □不通过 |
| ---------- || 外部一致性 | 是否与现有系统兼容 | □通过 □不通过 |
| ---------- |标准一致性 | 是否符合行业标准 | □通过 □不通过 |
| **可验证性** | 验收标准明确性 | 验收标准是否明确可测 | □通过 □不通过 |
| ------------ |测试用例可设计性 | 是否可以设计测试用例 | □通过 □不通过 |
| **可追溯性** | 需求来源可追溯 | 需求来源是否明确 | □通过 □不通过 |
| ------------ |需求变更可追溯 | 变更历史是否完整 | □通过 □不通过 |

**评审决策矩阵：**

| 评审结果 | 通过条件                 | 后续行动               |
| -------- | ------------------------ | ---------------------- |
| 完全通过 | 所有检查项都通过         | 进入设计阶段           |
| 条件通过 | 关键项通过，次要项有问题 | 修复问题后进入设计阶段 |
| 需要修改 | 重要项不通过             | 修改需求后重新评审     |
| 拒绝通过 | 关键项不通过             | 重新进行需求分析       |

### 6.4.3 需求变更管理模板


**需求变更请求模板：**

```json

变更请求编号：CR-[YYYY-MM-DD]-[序号]
提交日期：[日期]
提交人：[姓名]
项目名称：[项目名称]

变更概述：
[变更的简要描述]

变更详情：
原需求：[原始需求描述]
新需求：[变更后需求描述]
变更原因：[变更的业务原因]

影响分析：
变更请求编号：CR-[YYYY-MM-DD]-[序号]
提交日期：[日期]
提交人：[姓名]
项目名称：[项目名称]

变更概述：
[变更的简要描述]

变更详情：
原需求：[原始需求描述]
新需求：[变更后需求描述]
变更原因：[变更的业务原因]

影响分析：
1. 功能影响：[对现有功能的影响]
2. 技术影响：[对技术架构的影响]
3. 进度影响：[对项目进度的影响]
4. 成本影响：[对项目成本的影响]
5. 风险影响：[新增或变化的风险]

相关需求：
- 依赖的需求：[需求编号列表]
- 影响的需求：[需求编号列表]

评估结果：
工作量估算：[人天]
成本估算：[金额]
进度影响：[天数]

决策：
□ 批准
□ 拒绝
□ 延期处理

批准人：[姓名]
批准日期：[日期]
备注：[其他说明]
